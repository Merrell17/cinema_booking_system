{% extends 'base.html' %}

<!DOCTYPE html>
<html lang="en">
<head>
    {% block head %}

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/page.css') }}">
    <title>Register</title>

    {% endblock %}
</head>
{% block body %}
<body>

<h1>{{ title }} - {{ time }}</h1>
<div id="container">
</div>

<div id = "right">
<p id= "quantity">
 Select your seats!
 </p>

    <form method="POST" action="{{ url_for('booking.process_ticket')}}">
    <input type="hidden" id="hidden" name="hidden-ticket-value">

    <input type="submit" value="Book" id="book-btn">
    </form>

</div>

</body>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>
const container = document.getElementById("container");


var bookedSeats = [5,14,16]

function makeRows(rows, cols) {
  container.style.setProperty('--grid-rows', rows);
  container.style.setProperty('--grid-cols', cols);
  for (c = 0; c < (rows * cols); c++) {
    let cell = document.createElement("div");
    cell.innerText = (c + 1);
    cell.id = "seat" + c;
    cell.num = c;
    container.appendChild(cell).className = "seat";
  };
};

makeRows({{ rows }}, {{ columns }});

$('.seat').click((e) => {
	if(!(e.currentTarget.classList.contains('booked'))) {

		e.currentTarget.classList.toggle('selected');

    quantity = (document.getElementsByClassName("selected").length);

    document.getElementById("quantity").innerHTML = quantity + " Ticket(s)"
    document.getElementById("book-btn").style.display = "inline-block"
    if (quantity==0){
    	document.getElementById("quantity").innerHTML = "Select your seats!"
    	document.getElementById("book-btn").style.display = "none"
    }
    var all = $(".selected").map(function() {
    return this.num;
		}).get();
    console.log(all);
   document.getElementById("hidden").value = all;

  }
});

for(var i in bookedSeats){
	booked = (document.getElementById("seat" + bookedSeats[i]));
  booked.className = "seat booked"
}


$('#book-btn').click((e) => {


  var all = $(".selected").map(function() {
    return this.num;
}).get();



})

</script>

{%  endblock %}